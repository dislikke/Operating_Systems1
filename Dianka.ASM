format binary as 'img'

org 0x7C00

jmp start

msg db "Fedotova", 0
msg2 db "Diana", 0
msg3 db "NMT-323901", 0
msg1 db "Alekseevna", 0

;Настройка сегмента стека
start:
    cli                 ;Отключить прерывания
    mov ax, 0           ;Инициализация сегмента стека
    mov ss, ax
    mov sp, 0xFFFF      ;Установка указателя стека на верх
    sti                 ;Включить прерывания

    mov ax, 0x13        ; Переключение в режим 320x200 256-цвета
    int 0x10
    mov ax, 0x0010      ; Установка графического режима текста
    int 0x10

    ;Рисование равностороннего треугольника
    mov cx, 550          ;Х координата в левой половине экрана
    mov dx, 260          ;Y координата, высоко, чтобы разместить полную высоту
    mov bx, 120          ;Высота треугольника
    call draw_triangle


    ; Установка цвета фона
    mov ah, 0x0B        ; Функция для установки цвета фона
    mov bl, 0x07        ; Светло-серый цвет фона
    int 0x10

    ;Вывод текста
    mov ah, 0x13        ; Функция для вывода текста
    mov al, 0           ; Цвет - черный
    mov bh, 0           ; Страница экрана
    mov bl, 14          ; Цвет текста: желтый
    mov dl, 1          ;Колонка (towards the end of the screen)
    mov dh, 1          ;Строка
    push cs
    pop es
    mov bp, msg
    mov cx, 8          ;Длина текста
    int 0x10

    mov ah, 0x13        ; Функция для вывода текста
    mov al, 0           ; Цвет - черный
    mov bh, 0           ; Страница экрана
    mov bl, 14          ; Цвет текста: желтый
    mov dl, 1          ;Колонка
    mov dh, 2          ;Строка
    push cs
    pop es
    mov bp, msg2
    mov cx, 5           ;Длина текста
    int 0x10

    mov ah, 0x13        ; Функция для вывода текста
    mov al, 0           ; Цвет - черный
    mov bh, 0           ; Страница экрана
    mov bl, 14          ; Цвет текста: желтый
    mov dl, 1          ;Колонка
    mov dh, 3          ;Строка
    push cs
    pop es
    mov bp, msg1
    mov cx, 11          ;Длина текста
    int 0x10

    mov ah, 0x13        ; Функция для вывода текста
    mov al, 0           ; Цвет - черный
    mov bh, 0           ; Страница экрана
    mov bl, 14          ; Цвет текста желтый
    mov dl, 1          ;Колонка
    mov dh, 4          ;Строка
    push cs
    pop es
    mov bp, msg3
    mov cx, 10          ;Длина текста
    int 0x10

hang:
    jmp hang


    ;Функция для рисования равностороннего треугольника
    ;cx - начальная x координата
    ;dx - начальная y координата
    ;bx - высота треугольника

draw_triangle:
    pusha
    mov bp, cx            ;bp сохраним оригинал x координаты для сравнения

    ;Цикл отрисовки треугольника
triangle_loop:
    push cx
    mov ax, bx            ;ax для рисования линий уменьшающейся длины по очереди
    shr ax, 1
    sub cx, ax            ;Вычитание для получения начальной x координаты
    add ax, bp            ;Сложение для получения конечной x координаты

    ;Рисование горизонтальной линии
draw_line:
    cmp cx, ax            ;Проверка если начальный x (cx) меньше чем конечный x (ax)
    jae line_done         ;Если достигнут или пройден конец, линия закончена
    push ax
    push bx
    push dx

    mov ah, 0x0C          ;Функция для отрисовки пикселя
    mov al, 0x0F          ;Цвет - белый
    int 0x10              ;Прерывание BIOS

    pop dx
    pop bx
    pop ax
    inc cx                ;Переход к следующему пикселю справа
    jmp draw_line         ;Повтор цикла для следующего пикселя

line_done:
    pop cx
    add dx, 1             ;Переход на строку выше
    add cx, 1             ;Смещение начального x на один пиксель вправо
    dec bx                ;Уменьшение оставшейся высоты
    jnz triangle_loop     ;Континуум, если еще есть что рисовать в треугольнике

    popa                   ;Восстановление регистров
    ret

;Заполнение оставшейся части загрузочного сектора нулями и волшебным числом
times 510-($-$$) db 0
dw 0xAA55